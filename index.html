<!doctype html>
<html>

<head>

  <title>EPSchedule</title>

  <meta name="viewport" 
  content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

  <script src="bower_components/webcomponentsjs/webcomponents.js">
  </script>
  <script>
  var schedule = {{ schedule | safe }};
  var days = {{days | safe }};
  function renderSchedule(dateObj, emptyDiv) {
    var div = document.getElementById("schedule");
    if (emptyDiv) {
        div.innerHTML = "";
    }
    switch (dateObj.getDay()) { //Spits out the day of the week as a string
        case 0: //Intentionall fallthrough - requesting a Sunday or Saturday schedule should spit out a Monday schedule
        case 6:
        case 1:
            var day = "Monday";
            break;
        case 2:
            var day = "Tuesday";
            break;
        case 3:
            var day = "Wednesday";
            break;
        case 4:
            day = "Thursday";
            break;
        case 5:
            day = "Friday";
            break;
    }
    for (var exception = 0; exception < days[1].length; exception++) { //Handles exceptions, also handles special weekend schedules
        if (days[1][exception]["day"] == (dateObj.getDate() + 1) && days[1][exception]["month"] == (dateObj.getMonth() + 1) && days[1][exception]["year"] == dateObj.getYear()) {
            day = days[1][exception]["schedule"];
        }
    }
    var currentSlot;
    for (currentSlot = 0; currentSlot < days[0][day]["MS"].length; currentSlot++) {
        switch(days[0][day]["MS"][currentSlot]["period"]) { //Falling through is intended in switch statement
            case 1: //A period
            case 2: //B period
            case 3: //C period
            case 4: //D period
            case 5: //E period
            case 6: //F period
            case 7: //G period
            case 8: //H period
                var slotString = schedule["classes"][days[0][day]["MS"][currentSlot]["period"] - 1]["name"] + " - " + 
                schedule["classes"][days[0][day]["MS"][currentSlot]["period"] - 1]["teacher"] + " - " + 
                schedule["classes"][days[0][day]["MS"][currentSlot]["period"] - 1]["room"] + " - ";
                break;
            case 9: //Lunch
                var slotString = "Lunch - LPC Commons - ";
                break;
            case 10: //Assembly
                var slotString = "Assembly - LPC Commons - ";
                break;
            case 11: //Lunch
                var slotString = "Advisory - "; //TODO - Make this box display the user's advisor and advisory location
                break;
            case 12: //Class Meeting
                var slotString = "Class Meeting - "; //TODO - Make this box display the user's class meeting location
                break;
            case 13: //Clubs
                var slotString = "Club - ";
                break;
        }
        slotString += days[0][day]["MS"][currentSlot]["time"];
        appendPara(div, slotString);
    }
    
  }
  window.onload = function() {
    //var div = document.getElementById("schedule");
    var date = new Date();
    renderSchedule(date, false);
  }
  function appendPara(div, text) {
    var para = document.createElement("p");
    var node = document.createTextNode(text);
    para.appendChild(node);
    div.appendChild(para);
  }
  </script>

  <link rel="import" href="bower_components/font-roboto/roboto.html">
  <link rel="import"
    href="bower_components/core-toolbar/core-toolbar.html">
  <link rel="import"
    href="bower_components/core-header-panel/core-header-panel.html">
  <link rel="import"
    href="bower_components/core-icons/core-icons.html">
  <link rel="import"
    href="bower_components/paper-icon-button/paper-icon-button.html">

  <style>
  html,body {
    height: 100%;
    margin: 0;
    background-color: #E5E5E5;
    font-family: 'RobotoDraft', sans-serif;
  }
  .container {
    width: 80%;
    margin: 50px auto;
  }
  @media (min-width: 481px) {
    #tabs {
      width: 200px;
    }
    .container {
      width: 400px;
    }
  }
  </style>

</head>

<body fullbleed vertical layout unresolved>
  <core-header-panel flex>
    <core-toolbar id="mainheader">
      <paper-icon-button id="navicon"
        icon="arrow-back"></paper-icon-button>
      <span flex>EPSchedule</span>
      <paper-icon-button id="searchbutton"
        icon="search"></paper-icon-button>
    </core-toolbar>
    <div id="schedule" layout vertical center>
    </div>
  </core-header-panel>
  <div id="list">
   </div>
</body>

</html>